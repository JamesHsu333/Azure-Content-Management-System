(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-074f5c5b"],{"02c0":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"Name or Email",size:"mini"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),r("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("Create User")]),r("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",size:"mini",disabled:0===e.selectedUser.length},on:{click:function(t){return e.deleteConfirm(e.deleteSelectedUser,"Delete Selected User")}}},[e._v("Delete Selected User")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.filterUserInfo,"element-loading-text":"Loading User Information",fit:"","default-sort":{prop:"name",order:"ascending"}},on:{"selection-change":e.selectUser}},[r("el-table-column",{attrs:{type:"selection",width:"50"}}),r("el-table-column",{attrs:{align:"center",width:"120",label:"Name",prop:"name",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.displayName))]}}])}),r("el-table-column",{attrs:{label:"Account Name",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.userPrincipalName))])]}}])}),r("el-table-column",{attrs:{label:"Operation",width:"300"}},[[r("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"danger"}},[e._v("Delete User")])]],2)],1),r("form-create-user",{attrs:{isVisible:e.dialogFormVisible},on:{close:e.closeCreateUserForm,newUserData:e.newUserData}})],1)},a=[],i=(r("4de4"),r("caad6"),r("d81d"),r("d3b7"),r("2532"),r("3ca3"),r("841c"),r("ddb0"),r("96cf"),r("e8d1")),n=r("16c7"),o=function(e,t){return Object(i["b"])({url:"/users",method:"post",data:{accountEnabled:!0,displayName:e,mailNickname:e,userPrincipalName:e+"@"+n["b"],passwordProfile:{forceChangePasswordNextSignIn:!1,password:t}}})},l=function(e){return Object(i["b"])({url:"/users/"+e,method:"delete"})},c=function(){return Object(i["b"])({url:"/users/",method:"get"})},u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"Create User",visible:e.isVisible,"before-close":e.closeDialog},on:{"update:visible":function(t){e.isVisible=t}}},[r("el-tabs",{attrs:{stretch:""},model:{value:e.nowTab,callback:function(t){e.nowTab=t},expression:"nowTab"}},[r("el-tab-pane",{attrs:{label:"Create User",name:"first"}},[r("el-form",{ref:"createUserForm",staticStyle:{width:"350px","margin-left":"70px"},attrs:{model:e.createUserForm,rules:e.rules,"label-position":"right","label-width":"125px"}},[r("el-form-item",{attrs:{label:"User Name",prop:"name"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-user",size:"medium",clearable:""},model:{value:e.createUserForm.name,callback:function(t){e.$set(e.createUserForm,"name",t)},expression:"createUserForm.name"}})],1),r("el-form-item",{attrs:{label:"Assign Role",prop:"isAssign"}},[r("el-switch",{staticStyle:{left:"0"},model:{value:e.createUserForm.isAssign,callback:function(t){e.$set(e.createUserForm,"isAssign",t)},expression:"createUserForm.isAssign"}})],1),e.createUserForm.isAssign?r("el-form-item",{attrs:{label:"Resource Group",prop:"resourceGroupName"}},[r("el-select",{attrs:{filterable:"",placeholder:"Choose Resource Group",multiple:"","collapse-tags":""},model:{value:e.createUserForm.resourceGroupName,callback:function(t){e.$set(e.createUserForm,"resourceGroupName",t)},expression:"createUserForm.resourceGroupName"}},e._l(e.resourceGroups,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})})),1)],1):e._e(),e.createUserForm.isAssign?r("el-form-item",{attrs:{label:"Role",prop:"roleDefinitionId"}},[r("el-select",{attrs:{filterable:"",placeholder:"Choose Role"},model:{value:e.createUserForm.roleDefinitionId,callback:function(t){e.$set(e.createUserForm,"roleDefinitionId",t)},expression:"createUserForm.roleDefinitionId"}},e._l(e.roles,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.GUID}})})),1)],1):e._e()],1)],1),r("el-tab-pane",{attrs:{label:"Create Multiple User",name:"second"}},[r("el-form",{ref:"createMultiUserForm",staticStyle:{width:"350px","margin-left":"70px"},attrs:{model:e.createMultiUserForm,"label-position":"left",rules:e.rules,"label-width":"125px"}},[r("el-form-item",{attrs:{label:"User Name",prop:"name"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-user",size:"medium",clearable:""},model:{value:e.createMultiUserForm.name,callback:function(t){e.$set(e.createMultiUserForm,"name",t)},expression:"createMultiUserForm.name"}})],1),r("el-form-item",{attrs:{label:"User Numbers",prop:"range"}},[r("el-slider",{attrs:{range:"","show-stops":"",max:50},model:{value:e.createMultiUserForm.range,callback:function(t){e.$set(e.createMultiUserForm,"range",t)},expression:"createMultiUserForm.range"}})],1),r("el-form-item",{attrs:{label:"Assign Role",prop:"isAssign"}},[r("el-switch",{staticStyle:{left:"0"},model:{value:e.createMultiUserForm.isAssign,callback:function(t){e.$set(e.createMultiUserForm,"isAssign",t)},expression:"createMultiUserForm.isAssign"}})],1),e.createMultiUserForm.isAssign?r("el-form-item",{attrs:{label:"Role",prop:"roleDefinitionId"}},[r("el-select",{attrs:{filterable:"",placeholder:"Choose Role"},model:{value:e.createMultiUserForm.roleDefinitionId,callback:function(t){e.$set(e.createMultiUserForm,"roleDefinitionId",t)},expression:"createMultiUserForm.roleDefinitionId"}},e._l(e.roles,(function(e){return r("el-option",{key:e.name,attrs:{label:e.name,value:e.GUID}})})),1)],1):e._e()],1),e.createMultiUserForm.isAssign?r("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"Please make sure that Resource Group is exist before assign role",type:"warning",closable:!1}}):e._e(),e.createMultiUserForm.isAssign?r("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"User will assign to Resource Group of which name equals to User Name",type:"info",closable:!1}}):e._e()],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){return e.$emit("close",!1)}}},[e._v("Cancel")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){"first"===e.nowTab?e.confirmCreateUserForm():e.confirmCreateMultiUserForm()}}},[e._v("Confirm")])],1)],1)},m=[],f=(r("b0c0"),r("25f0"),r("25b2")),d=(r("cb29"),r("a15b"),r("5319"),function(e,t){return Array(e).fill(t).map((function(e){return e[Math.floor(Math.random()*e.length)]})).join("")}),p=function(){var e=d(1,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")+d(3,"abcdefghijklmnopqrstuvwxy")+d(4,"0123456789");return console.log(e),e},h=function(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=((new Date).getTime()+16*Math.random())%16|0;return("x"==e?t:3&t|8).toString(16)}));return e},g={name:"CreateUserForm",props:{isVisible:{type:Boolean,required:!0}},data:function(){return{nowTab:"first",isFormValid:!1,resourceGroups:[{}],createUserForm:{},createMultiUserForm:{range:[1,15]},rules:{name:[{required:!0,message:"Type User Name",trigger:"blur"},{min:4,max:16,message:"User Name must have length between 5 to 16",trigger:"blur"}],assignRG:[{required:!0,message:"Please Choose Resource Group",trigger:"change"}],role:[{required:!0,message:"Please Choose Role",trigger:"change"}]},roles:[{name:"Contributer",GUID:"b24988ac-6180-42a0-ab88-20f7382dd24c"},{name:"Owner",GUID:"8e3af657-a8ff-443c-a75c-2fe8c4bcb635"},{name:"Reader",GUID:"acdd72a7-3385-48ef-bd42-f606fba81ae7"}]}},created:function(){this.getResourceGroups()},methods:{getResourceGroups:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(Object(f["f"])());case 2:e=t.sent,this.resourceGroups=e.data.value;case 4:case"end":return t.stop()}}),null,this)},createUser:function(e){var t;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(o(e,p()));case 2:return t=r.sent,this.$message({type:"success",message:"Successfully Create User: "+e}),this.$emit("newUserData",t.data),r.abrupt("return",t.data);case 6:case"end":return r.stop()}}),null,this)},createMultiUser:function(e){for(var t=this,r=e.name,s=e.range,a=[],i=s[0];i<=s[1];i++)a[i-s[0]]=r+i.toString();Promise.all(a.map((function(e){t.createUser(e)})))},createMultiUserRole:function(e){for(var t=this,r=e.name,s=e.range,a=e.roleDefinitionId,i=[],n=s[0];n<=s[1];n++)i[n-s[0]]=r+n.toString();Promise.all(i.map((function(e){t.createUser(e).then((function(r){t.createRoleAssignment(r.id,{roleDefinitionId:a,resourceGroupName:e})}))})))},createRoleAssignment:function(e,t){var r,s;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.roleDefinitionId,s=t.resourceGroupName,a.next=3,regeneratorRuntime.awrap(Object(f["b"])({roleAssignName:h(),roleDefinitionId:r,userId:e,resourceGroupName:s}));case 3:this.$message({type:"success",message:"Successfully Assign User to Resource Group: "+s});case 4:case"end":return a.stop()}}),null,this)},confirmCreateUserForm:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:if(this.validateForm("createUserForm"),!this.isFormValid){t.next=11;break}if(!this.createUserForm.isAssign){t.next=9;break}return t.next=5,regeneratorRuntime.awrap(this.createUser(this.createUserForm.name));case 5:e=t.sent,this.createRoleAssignment(e.id,this.createUserForm),t.next=10;break;case 9:this.createUserForm.isAssign||this.createUser(this.createUserForm.name);case 10:this.closeDialog();case 11:case"end":return t.stop()}}),null,this)},confirmCreateMultiUserForm:function(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:this.validateForm("createMultiUserForm"),this.isFormValid&&(this.createMultiUserForm.isAssign?this.createMultiUserRole(this.createMultiUserForm):this.createMultiUserForm.isAssign||this.createMultiUser(this.createMultiUserForm),this.closeDialog());case 2:case"end":return e.stop()}}),null,this)},validateForm:function(e){var t=this;this.$refs[e].validate((function(e){t.isFormValid=!!e}))},closeDialog:function(){this.$emit("close",!1)}}},b=g,U=r("2877"),x=Object(U["a"])(b,u,m,!1,null,null,null),v=x.exports,F={components:{FormCreateUser:v},data:function(){return{list:[{}],listLoading:!1,selectedUser:[],dialogFormVisible:!1,search:""}},computed:{filterUserInfo:function(){var e=this;return this.list.filter((function(t){return!e.search||t.displayName.toLowerCase().includes(e.search.toLowerCase())||t.userPrincipalName.toLowerCase().includes(e.search.toLowerCase())}))}},created:function(){this.getUser()},methods:{getUser:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.listLoading=!0,t.next=4,regeneratorRuntime.awrap(c());case 4:e=t.sent,this.list=e.data.value,this.listLoading=!1,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),null,this,[[0,9]])},deleteSelectedUser:function(){var e=this;Promise.all(this.selectedUser.map((function(e){l(e.id)}))).then((function(){e.list=e.list.filter((function(t){return!e.selectedUser.includes(t)})),e.$message({message:"Successful Delete User",type:"success"})}))},selectUser:function(e){this.selectedUser=e},deleteConfirm:function(e,t){var r=this;this.$confirm("Do you want to "+t,t,{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}).then((function(){e()})).catch((function(){r.$message({type:"info",message:"Has Canceled"})}))},closeCreateUserForm:function(e){this.dialogFormVisible=e},newUserData:function(e){this.$set(this.list,this.list.length,e)}}},w=F,y=Object(U["a"])(w,s,a,!1,null,null,null);t["default"]=y.exports},"81d5":function(e,t,r){"use strict";var s=r("7b0b"),a=r("23cb"),i=r("50c4");e.exports=function(e){var t=s(this),r=i(t.length),n=arguments.length,o=a(n>1?arguments[1]:void 0,r),l=n>2?arguments[2]:void 0,c=void 0===l?r:a(l,r);while(c>o)t[o++]=e;return t}},a15b:function(e,t,r){"use strict";var s=r("23e7"),a=r("44ad"),i=r("fc6a"),n=r("b301"),o=[].join,l=a!=Object,c=n("join",",");s({target:"Array",proto:!0,forced:l||c},{join:function(e){return o.call(i(this),void 0===e?",":e)}})},cb29:function(e,t,r){var s=r("23e7"),a=r("81d5"),i=r("44d2");s({target:"Array",proto:!0},{fill:a}),i("fill")}}]);
//# sourceMappingURL=chunk-074f5c5b.edc69cd5.js.map